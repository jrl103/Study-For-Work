# Next.js 란 ?

- React 를 기반으로하는 웹 개발 프레임워크


- Full-stack 개발 
- File-based Routing 
- API Routing 
- SEO, Image, Font 최적화 
- SSR(+ 하이브리드 렌더링)
- Pre-Rendering 
- 등에 다양한 기능을 제공해줌

 ## Next.js 원칙

1. 복잡한 설정을 하지 않아도 프레임워크를 사용하기 쉬울것
2. 자동 코드 분할과 서버 렌더링을 지원
3. data fetching 설정 가능
4. 요청을 예상 가능
5. 배포가 쉬움

## 2022.10 --> Next.js v13 출시

### 1. New Routing(App Routing)

- 기존 pages 에서 app 으로 라우팅하는 방식이 추가됨

#### 2. Server Component

- `App` 폴더에 작성한 리액트 컴포넌트들은 기본적으로 `서버 컴포넌트`로 동작함
  - 해당 코드들은 서버에서만 실행이 된다는 의미

1. 서버 컴포넌트는 서버에서 실행이 이루어진다.
2. 서버에서 동작하므로, `브라우저에서 사용하는 API` 및 useEffect(), useState() 등의 코드는 `사용 불가`
3. `Node.js API` `사용 가능`

- 이벤트 바인딩 및 useEffect(), useState() 와 같은 코드를 사용하려면 클라이언트 컴포넌트를 사용해야함
  - 코드 최상단에, `use client` 라는 지시어를 명시


- 클라이언트 컴포넌트라고 해서, 클라이언트에서만 실행되지는 않음
  - `Pre-Rendering` 과정에서 해당 코드를 실행하여 `HTML` 로 렌더링할 부분들을 렌더링 시킴


- 서버 컴퍼넌트는 클라이언트 컴포넌트를 포함이 가능하나, 클라이언트 컴포넌트가 서버 컴포넌트를 포함할 수는 X


#### 3. Streaming

- 서버에서 클라이언트로 `HTML 을 작게 나누어 점진적으로 렌더링`
- 서버에서 HTML 을 렌더링 하기전에 데이터 `fetch` 작업등으로 `블로킹`될 수 있는데, 이를 `개선`하기 위해 사용하는 기능
  - 모든 데이터를 기다릴 필요없이 페이지의 일부를 더 빨리 표시하여 상호작용


#### 4. Data Fetching

- App 디렉토리는 기본적으로 서버 컴포넌트로 동작
  - 즉, 서버에서 데이터를 불러오는 작업 : 별도의 설정 없이 바로 가능
  - v12 까지는 getStaticProps(), getServerSideProps() 메서드를 사용하여 SSR을 사용할지 SSG를 사용할지 정의해서 사용했음

```javascript
fetch(URL, { cache: 'force-cache' });

// no-store --> SSR
fetch(URL, { cache: 'no-store' });

fetch(URL, { next: { revalidate: 10 } });

// revalidate: 0  --> SSR
// 기본적으로, 아무 설정도 안하면 SSG
```

### 5. next/Image

Image 컴포넌트 로딩 방식이 변경되었고 성능이 개선
: `이미지 리사이징`, `lazy 로딩` 등에 편리한 기능들을 제공

1. 하이드레이션을 필요로 하지 않는 `native lazy-loading` 으로 `속도 향상`
2. `width`, `height` 를 전달받아 `레이아웃 시프트 방지`
3. 기존 이미지 컴포넌트는 next/legacy/image로 변경됨


### 6. Improved next/link

- `<Link>` 컴포넌트에 더 이상 수동으로 `<a>` 태그를 하위에 추가할 필요가 없어짐
- `<Link>`는 이제 기본값으로 `<a>` 태그를 렌더링하며, `<a>` 태그의 `Props` 들을 정상적으로 전달할 수 있음


# React 를 사용하는 이유는 ?

#### `SEO(Search Engine Optimization)`를 위한 `Server-Side Rendering(SSR)`을 가능하게 하기 때문에

## Next 의 장점

### 1. automatic routing

- 기존에 CRA 로 개발했을 때는 index.js만 불러와서 SPA 방식으로 라우팅에 따라 컴포넌트를 교체하는데,
  - Next.js로 개발하게 되면 `pages 디렉토리에 있는 파일을 기준`으로 라우터별로 다른 페이지로 넘어가게 된다. 
- Next.j s에서 지원해 주는 `Head` 등을 통해 `메타 태그`를 입력해 주면 `SEO` 에 문제가 없다.

#### 2. Next.js는 자동으로 `코드 스플리팅` 을 한다.

- 번들이 거대해지는 것을 방지하기 위해 `여러 번들을 동적으로 생성`하고 불러오는 `코드 분할` 즉, `코드 스플리팅` 을 지원
  - 장점
  - `Lazy Loading(지연 로딩)` 도와줌
  - 코드 양을 줄이지 않고도 필요하지 않은 코드를 불러오지 않게 하여 `초기 로딩에 필요한 자원을 줄여즘`
  - 정리하면, 번들링된 파일을 분할해서 로드하여 초기 구동 속도를 빠르게 하고 성능 향상을 제공

> [ 번들링 ]
> - 보통 개발을 할 때, 속도가 느리거나 혹은 메모리가 낮은 기기를 활용할 때 여러 가지 불편함이 발생
> - 이런 문제를 사전에 방지하고자 자바스크립트 프로젝트를 생성할 때, `모든 코드를 하나의 Bundle(묶음)으로 만드는 과정`

- Next.js의 프로덕션 빌드 내, 
  - 브라우저의 뷰 포트에서 `Link` 컴포넌트가 등장 할 때는 언제나 Next.js가 백그라운드에서 링크된 페이지를 위해 `자동으로 코드를 프리패치`
  - `백그라운드에 미리 로드`되어, `페이지 전환이 거의 즉시 이루어짐`

























